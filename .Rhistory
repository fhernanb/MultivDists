x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
l1 <- 1
l2 <- 2
correct_alpha_BP_Laksh(l1=l1, l2=l2)
alpha <- -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
alpha <- -1 # -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
alpha <- -1 # -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
alpha <- -1 # -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
alpha <- -1 # -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
alpha <- -1 # -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
alpha <- -1 # -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
alpha <- -1 # -2.7
x <- rBP_Laksh(n=50, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
x <- rBP_Laksh(n=5000, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
x <- rBP_Laksh(n=5000, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
x <- rBP_Laksh(n=5000, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
x <- rBP_Laksh(n=500, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
# To create start parameters
min_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$min_alpha
max_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$max_alpha
start_param <- theta
names(start_param) <- c("l1_hat", "l2_hat", "alpha_hat")
start_param
#' @export
moments_estim_BP_Laksh <- function(x) {
# For l1
l1_hat <- mean(x[,1])
# For l1
l2_hat <- mean(x[,2])
n <- nrow(x)
k <- 1 - exp(-1)
A <- exp(-l1_hat*k)
B <- exp(-l2_hat*k)
# For alpha
c_x_y <- sum((x[,1]-l1_hat) * (x[,2]-l2_hat)) / n
alpha_hat <- c_x_y / (l1_hat * l2_hat * A * B * k^2)
# Auxiliar functio to check if alpha_hat is inside the interval
aux_check <- function(alpha_hat, l1_hat, l2_hat) {
min_alpha <- correct_alpha_BP_Laksh(l1=l1_hat, l2=l2_hat)$min_alpha
max_alpha <- correct_alpha_BP_Laksh(l1=l1_hat, l2=l2_hat)$max_alpha
alpha_hat <- ifelse(alpha_hat > max_alpha, max_alpha,
ifelse(alpha_hat < min_alpha, min_alpha, alpha_hat))
return(alpha_hat)
}
# Using the correlation to estimate alpha
alpha_hat_cor <- cor(x)[2] / (sqrt(l1_hat*l2_hat)*k^2*exp(-(l1_hat+l2_hat)*k))
# Adjusting the alpha_hat's to ensure that it is inside in a correct interval
alpha_hat     <- aux_check(alpha_hat=alpha_hat,     l1_hat=l1_hat, l2_hat=l2_hat)
alpha_hat_cor <- aux_check(alpha_hat=alpha_hat_cor, l1_hat=l1_hat, l2_hat=l2_hat)
res <- c(l1_hat=l1_hat,
l2_hat=l2_hat,
#alpha_hat=alpha_hat,
alpha_hat_cor=alpha_hat_cor
)
return(round(res, digits=4))
}
l1 <- 1
l2 <- 2
correct_alpha_BP_Laksh(l1=l1, l2=l2)
alpha <- -2.7
x <- rBP_Laksh(n=500, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
# To create start parameters
min_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$min_alpha
max_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$max_alpha
start_param <- theta
names(start_param) <- c("l1_hat", "l2_hat", "alpha_hat")
start_param
# Estimating parameters
res1 <- optim(fn = llBP_Laksh,
par = start_param,
lower = c(0.001, 0.001, min_alpha),
upper = c(  Inf,   Inf, max_alpha),
method = "L-BFGS-B",
control = list(maxit=100000, fnscale=-1),
x=x)
res1
set.seed(1234)
x <- rBP_Laksh(n=500, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
# To create start parameters
min_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$min_alpha
max_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$max_alpha
start_param <- theta
names(start_param) <- c("l1_hat", "l2_hat", "alpha_hat")
start_param
# Estimating parameters
res1 <- optim(fn = llBP_Laksh,
par = start_param,
lower = c(0.001, 0.001, min_alpha),
upper = c(  Inf,   Inf, max_alpha),
method = "L-BFGS-B",
control = list(maxit=100000, fnscale=-1),
x=x)
set.seed(12345)
x <- rBP_Laksh(n=500, l1=l1, l2=l2, alpha=alpha)
# To obtain reasonable values for alpha
theta <- as.numeric(moments_estim_BP_Laksh(x))
theta
# To create start parameters
min_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$min_alpha
max_alpha <- correct_alpha_BP_Laksh(l1=theta[1],
l2=theta[2])$max_alpha
start_param <- theta
names(start_param) <- c("l1_hat", "l2_hat", "alpha_hat")
start_param
# Estimating parameters
res1 <- optim(fn = llBP_Laksh,
par = start_param,
lower = c(0.001, 0.001, min_alpha),
upper = c(  Inf,   Inf, max_alpha),
method = "L-BFGS-B",
control = list(maxit=100000, fnscale=-1),
x=x)
res1
x <- rep(0:5, each=6)
y <- rep(0:5, times=6)
freq <- c(7,  41, 54, 40, 21, 9,
36, 79, 83, 59, 30, 13,
39, 70, 69, 47, 25, 10,
24, 41, 39, 26, 14, 6,
10, 18, 18, 11, 6, 2,
3, 6, 6, 4, 2, 1)
x <- rep(0:5, each=6)
y <- rep(0:5, times=6)
freq <- c(7,  41, 54, 40, 21, 9,
36, 79, 83, 59, 30, 13,
39, 70, 69, 47, 25, 10,
24, 41, 39, 26, 14, 6,
10, 18, 18, 11, 6, 2,
3, 6, 6, 4, 2, 1)
seed_plants <- NULL
for (i in 1:36) {
temp <- matrix(c(x[i], y[i]),  ncol=2, nrow=freq[i], byrow=TRUE)
seed_plants <- rbind(seed_plants, temp)
}
seed_plants
colMeans(seed_plants)
var(seed_plants)
cor(seed_plants)
moments_estim_BP_Laksh(seed_plants)
correct_alpha_BP_Laksh(l1=1.6925, l2=2.0134)
optim(fn = llBP_Laksh,
par = c(1.69, 2.01, -1.32),
lower = c(0.0001, 0.0001, -2.11),
upper = c(Inf, Inf, 2.11),
method = "L-BFGS-B",
control = list(maxit=100000, fnscale=-1),
x=seed_plants)
# Correct interval for alpha according to l1_hat and l2_hat
correct_alpha_BP_Laksh(l1=1.6925, l2=2.0134)
# Moment estimators
moments_estim_BP_Laksh(seed_plants)
# Finding the log-likelihood estimators using
optim(fn = llBP_Laksh,
par = c(1.6925, 2.0134, -1.3230),
lower = c(0.0001, 0.0001, -2.114373),
upper = c(Inf, Inf, 2.114373),
method = "L-BFGS-B",
control = list(maxit=100000, fnscale=-1),
x=seed_plants)
# Moment estimators
moments_estim_BP_Laksh(seed_plants)
devtools::document()
devtools::load_all()
devtools::document()
devtools::load_all()
devtools::document()
devtools::install()
pkgdown::build_site()
library(MultivDists)
# Probability for single values of X1 and X2
dZIBP_Laksh(c(0, 0), l1=3, l2=4, alpha=1, psi=0.15)
dZIBP_Laksh(c(1, 0), l1=3, l2=4, alpha=1, psi=0.15)
dZIBP_Laksh(c(0, 1), l1=3, l2=4, alpha=1, psi=0.15)
# Probability for a matrix the values of X1 and X2
x <- matrix(c(0, 0,
1, 0,
0, 1), ncol=2, byrow=TRUE)
x
dZIBP_Laksh(x=x, l1=3, l2=4, alpha=1, psi=0.15)
# Checking if the probabilities sum 1
val_x1 <- val_x2 <- 0:50
space <- expand.grid(val_x1, val_x2)
space <- as.matrix(space)
l1 <- 3
l2 <- 4
alpha <- -1.27
psi <- 0.15
probs <- dZIBP_Laksh(x=space, l1=l1, l2=l2, alpha=alpha, psi=psi)
sum(probs)
l1 <- 3
l2 <- 4
alpha <- -1.2
psi <- 0.15
X1 <- 0:10
X2 <- 0:10
data <- expand.grid(X1=X1, X2=X2)
data$Prob <- dZIBP_Laksh(x=data, l1=l1, l2=l2, alpha=alpha, psi=psi)
data$X1 <- factor(data$X1)
data$X2 <- factor(data$X2)
library(ggplot2)
ggplot(data, aes(X1, X2, fill=Prob)) +
geom_tile() +
scale_fill_gradient(low="darkgreen", high="yellow")
# Generating random values and moment estimations
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.30
x <- rZIBP_Laksh(n=500, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.30
x <- rZIBP_Laksh(n=500, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.30
x <- rZIBP_Laksh(n=500, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.30
x <- rZIBP_Laksh(n=500, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.30
x <- rZIBP_Laksh(n=500, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.30
x <- rZIBP_Laksh(n=500, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.30
x <- rZIBP_Laksh(n=500, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
correct_alpha_BP_Laksh(1, 2)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.30
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.30
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.30
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.30
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.30
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
estim <- moments_estim_ZIBP_Laksh(x)
estim
estim
l1 <- 1
l2 <- 2
alpha <- 2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
estim <- moments_estim_ZIBP_Laksh(x)
1 - mean(x[, 1]) / estim[1]
1 - mean(x[, 2]) / estim[2]
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
estim <- moments_estim_ZIBP_Laksh(x)
1 - mean(x[, 1]) / estim[1]
1 - mean(x[, 2]) / estim[2]
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
estim <- moments_estim_ZIBP_Laksh(x)
1 - mean(x[, 1]) / estim[1]
1 - mean(x[, 2]) / estim[2]
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
estim <- moments_estim_ZIBP_Laksh(x)
1 - mean(x[, 1]) / estim[1]
1 - mean(x[, 2]) / estim[2]
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
estim <- moments_estim_ZIBP_Laksh(x)
1 - mean(x[, 1]) / estim[1]
1 - mean(x[, 2]) / estim[2]
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
moments_estim_ZIBP_Laksh(x)
estim <- moments_estim_ZIBP_Laksh(x)
1 - mean(x[, 1]) / estim[1]
1 - mean(x[, 2]) / estim[2]
l1 <- 1
l2 <- 2
alpha <- -2.7
psi <- 0.05
x <- rZIBP_Laksh(n=50000, l1, l2, alpha, psi)
estim <- moments_estim_ZIBP_Laksh(x)
1 - mean(x[, 1]) / estim[1]
1 - mean(x[, 2]) / estim[2]
x <- rZIBP_Laksh(n=5000, l1, l2, alpha, psi)
# Sample means
colMeans(x)
# The theoretical means
theo_mean(l1=l1, l2=l2, alpha=alpha, psi=psi)
